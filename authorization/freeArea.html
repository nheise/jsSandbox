<html>
<head>
<script src='http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js'></script>
</head>
<body>
  <p>free area...</p>
  <p>
    <a href='/secure'>to secure area...</a>
  </p>
  <form id='login' action='/login'>
    <p>
      User:<input type='text' name='user' />
    </p>
    <p>
      Pass:<input type='password' name='pass' />
    </p>
    <p>
      <input type='submit' value='login' />
    </p>
  </form>
  <script type="text/javascript">
      var login = $( '#login' );
      login.submit( function() {
        var form = $( this );

        var loginButton = form.find( 'input[type="submit"]' );
        toggleDisabled( loginButton );

        var action = form.attr( 'action' );
        var user = form.find( 'input[name="user"]' ).val();
        var pass = form.find( 'input[name="pass"]' ).val();

        $.ajax( {
          type : 'GET',
          url : action,
          dataType : 'json',
          username : user,
          password : pass,
          success : function( data ) {
            toggleDisabled( loginButton );
            window.location.href = data.ref;
          },
          statusCode : {
            403 : function( data, status, thrown ) {
              setErrorMessages( $.parseJSON( data.responseText ).error );
              toggleDisabled( loginButton );
            }
          }
        } );

        return false;
      } );

      function setErrorMessages( message ) {
        
        var messageElement = '<li>' + message + '</li>';
        
        $( '#login' ).after( $( '<ul/>', {
          'id' : 'messages',
          html : messageElement
        } ) );
      }

      function toggleDisabled( element ) {
        if ( element.attr( 'disabled' ) ) {
          element.removeAttr( 'disabled' );
        } else {
          element.attr( 'disabled', 'disabled' );
        }
      };
    </script>
</body>
</html>